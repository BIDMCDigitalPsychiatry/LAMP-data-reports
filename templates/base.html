<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}LAMP Reports{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384‑ZxYjQ/…(shortened)…" crossorigin="anonymous">
  <!-- your overrides -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <nav class="navbar navbar-light bg-light mb-4 px-3 rounded shadow-sm">
    <span class="navbar-brand fw-bold">LAMP Reports</span>
    
    <div class="d-flex align-items-center">
        <button id="themeToggle" class="theme-toggle" title="Toggle dark mode">
            <!-- Moon icon (for light mode) -->
            <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <!-- Sun icon (for dark mode) -->
            <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        </button>
      
      {% if current_user.is_authenticated %}
        <span class="me-3">Hi, {{ current_user.username }} ({{ current_user.role }})</span>
        <a class="btn btn-outline-danger btn-sm" href="{{ url_for('logout') }}">Logout</a>
      {% endif %}
    </div>
  </nav>
  
  {% with msgs = get_flashed_messages(with_categories=true) %}
    {% if msgs %}
      {% for cat, msg in msgs %}
        <div class="flash {{cat}}">{{ msg }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const themeToggle = document.getElementById('themeToggle');
      const body = document.body;
      
      // Check for saved theme preference
      const darkMode = localStorage.getItem('darkMode') === 'enabled';
      
      // Apply saved preference
      if (darkMode) {
        body.classList.add('dark-mode');
      }
      
      // Toggle dark mode on button click
      themeToggle.addEventListener('click', function() {
        if (body.classList.contains('dark-mode')) {
          body.classList.remove('dark-mode');
          localStorage.setItem('darkMode', 'disabled');
        } else {
          body.classList.add('dark-mode');
          localStorage.setItem('darkMode', 'enabled');
        }
      });
    });
  </script>
</body>
</html>